# About the project, in my words

It's a Raffle to win a NFT.

1. Users can participate by calling `EnterRaffle` function with the following parameter `address[] participants`, allowing them to enter multiple times or with a group of friends.
2. A user cannot enter the raffle more than once (no duplicate addresses).
3. Users can get a refund for their tickets and amount spent `value` by calling `refund` function.
4. Every X seconds, the raffle will draw a winner and mint a random puppy NFT.
5. The owner will receive a fee `feeAddress`, with the remaining funds sent to the winner.

# Informational

`PuppyRaffle:entranceFee` is immutable, and should be like `i_entraceFee`.

# Roles

- Owner: Deployer of the protocol, has the power to change the wallet address to which fees are sent through the changeFeeAddress function.
- Player: Participant of the raffle, has the power to enter the raffle with the enterRaffle function and refund value through refund function.

# Attack vectors

## High

- Found a DOS `PuppyRaffle:94`

## Slither Findings

Red:

- PuppyRaffle.withdrawFees() (src/PuppyRaffle.sol#161-167) sends eth to arbitrary user
  Dangerous calls: - (success,None) = feeAddress.call{value: feesToWithdraw}() (src/PuppyRaffle.sol#165)
  Reference: https://github.com/crytic/slither/wiki/Detector-Documentation#functions-that-send-ether-to-arbitrary-destinations
  INFO:Detectors:

- PuppyRaffle.selectWinner() (src/PuppyRaffle.sol#129-158) uses a weak PRNG: "winnerIndex = uint256(keccak256(bytes)(abi.encodePacked(msg.sender,block.timestamp,block.difficulty))) % players.length (src/PuppyRaffle.sol#132-133)"
  Reference: https://github.com/crytic/slither/wiki/Detector-Documentation#weak-PRNG
  INFO:Detectors:

Yellow:

- PuppyRaffle.withdrawFees() (src/PuppyRaffle.sol#161-167) uses a dangerous strict equality: - require(bool,string)(address(this).balance == uint256(totalFees),PuppyRaffle: There are currently players active!) (src/PuppyRaffle.sol#162)
  Reference: https://github.com/crytic/slither/wiki/Detector-Documentation#dangerous-strict-equalities

INFO:Detectors:

- Reentrancy in PuppyRaffle.refund(uint256) (src/PuppyRaffle.sol#100-109):
- External calls: - address(msg.sender).sendValue(entranceFee) (src/PuppyRaffle.sol#105)
- State variables written after the call(s): - players[playerIndex] = address(0) (src/PuppyRaffle.sol#107)
- PuppyRaffle.players (src/PuppyRaffle.sol#23) can be used in cross function reentrancies: - PuppyRaffle.enterRaffle(address[]) (src/PuppyRaffle.sol#83-96) - PuppyRaffle.getActivePlayerIndex(address) (src/PuppyRaffle.sol#114-121) - PuppyRaffle.players (src/PuppyRaffle.sol#23) - PuppyRaffle.refund(uint256) (src/PuppyRaffle.sol#100-109) - PuppyRaffle.selectWinner() (src/PuppyRaffle.sol#129-158)
  Reference: https://github.com/crytic/slither/wiki/Detector-Documentation#reentrancy-vulnerabilities-1
